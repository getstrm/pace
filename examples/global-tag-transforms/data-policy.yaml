metadata:
  description: ""
  version: 1
  title: public.demo
platform:
  id: global_transforms-sample-connection
  platform_type: POSTGRES
source:
  fields:
    - name_parts:
        - transactionid
      required: true
      type: integer
    - name_parts:
        - userid
      required: true
      type: integer
    - name_parts:
        - email
      required: true
      type: varchar
    - name_parts:
        - age
      required: true
      type: integer
    - name_parts:
        - brand
      required: true
      type: varchar
    - name_parts:
        - transactionamount
      required: true
      type: integer
  ref: public.demo
rule_sets:
  - target:
      fullname: public.demo_view
    filters:
      - conditions:
          - principals: [ { group: administrator }, { group: fraud_and_risk } ]
            condition: "true"
          - principals: [ ]
            condition: "age > 8"
    field_transforms:
      - field:
          name_parts: [ userid ]
        transforms:
          - principals: [ { group: fraud_and_risk }, { group: administrator } ]
            identity: { }
          - principals: [ ]
            fixed:
              value: "0000"
      - field:
          name_parts: [ brand ]
        transforms:
          - principals: [ { group: administrator } ]
            identity: { }
          - principals: [ ]
            sql_statement:
              statement: "CASE WHEN brand = 'Macbook' THEN 'Apple' ELSE 'Other' END"
